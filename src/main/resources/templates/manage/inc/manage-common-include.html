<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="ko">

<head th:fragment="main-include">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>웨이플러스 관리자</title>
	<!--/* Font Awesome */-->
	<link rel="stylesheet" href="/plugin/fontawesome-free/css/all.min.css">
	<link rel="stylesheet" href="/plugin/fontawesome-free/css/v4-shims.css">

	<!--/* 미사용
	# Bootstrap 4
	<script type="text/javascript" src="/plugin/bootstrap/bootstrap.bundle.min.js"></script>
	<link rel="stylesheet" href="/plugin/bootstrap/css/bootstrap.css">

	# Tempusdominus Bootstrap 4
	<link rel="stylesheet" href="/plugin/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
	<script type="text/javascript" src="/plugin/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>

	# iCheck
	<link rel="stylesheet" href="/plugin/icheck-bootstrap/icheck-bootstrap.min.css">

	# JQVMap
	<link rel="stylesheet" href="/plugin/jqvmap/jqvmap.min.css">
	<script type="text/javascript" src="/plugin/jqvmap/jquery.vmap.min.js"></script>
	<script type="text/javascript" src="/plugin/jqvmap/maps/jquery.vmap.usa.js"></script>

	# summernote
	<script type="text/javascript" src="/plugin/summernote/summernote-bs4.min.js"></script>
	<link rel="stylesheet" href="/plugin/summernote/summernote-bs4.min.css">

	# Sparkline
	<script type="text/javascript" src="/plugin/sparklines/sparkline.js"></script>

	*/-->

	<!--/* jQuery */-->
	<script type="text/javascript" src="/js/jquery-3.6.0.min.js"></script>

	<!--/* jQuery UI 1.13.1 */-->
	<script type="text/javascript" src="/plugin/jquery-ui-1.13.1/jquery-ui.min.js" th:src="@{/plugin/jquery-ui-1.13.1/jquery-ui.min.js}"></script>

	<!--/* overlayScrollbars */-->
	<link rel="stylesheet" href="/plugin/overlayScrollbars/css/OverlayScrollbars.min.css">
	<script type="text/javascript" src="/plugin/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>

	<!--/* jQuery Knob Chart */-->
	<script type="text/javascript" src="/plugin/jquery-knob/jquery.knob.min.js"></script>

	<!--/* Bootstrap 4 */-->
	<script type="text/javascript" src="/plugin/bootstrap/js/bootstrap.bundle.min.js"></script>

	<!--/* Bootstrap 4 toggle */-->
	<link rel="stylesheet" href="/plugin/bootstrap4-toggle/bootstrap4-toggle.3.6.1.min.css">
	<script type="text/javascript" src="/plugin/bootstrap4-toggle/bootstrap4-toggle.3.6.1.min.js"></script>

	<!--/* Bootstrap 4 select*/-->
	<link rel="stylesheet" href="/plugin/bootstrap/css/bootstrap-select.css">
	<script type="text/javascript" src="/plugin/bootstrap/js/bootstrap-select.js"></script>
	<script type="text/javascript" src="/plugin/bootstrap/js/i18n/defaults-ko_KR.js"></script>

	<!--/* datatables */-->
	<link rel="stylesheet" href="/plugin/datatables-bs4/css/dataTables.bootstrap4.min.css">
<!--/*
	<link rel="stylesheet" href="/plugin/datatables-buttons/css/buttons.bootstrap4.min.css">
	<link rel="stylesheet" href="/plugin/datatables-responsive/css/responsive.bootstrap4.min.css">
*/-->
	<script type="text/javascript" src="/plugin/datatables/dataTables.korean.js" defer="defer"></script>
	<script type="text/javascript" src="/plugin/datatables/jquery.dataTables.js"></script>
	<script type="text/javascript" src="/plugin/datatables-bs4/js/dataTables.bootstrap4.js"></script>

<!--/*
	<script type="text/javascript" src="/plugin/datatables-responsive/js/dataTables.responsive.min.js"></script
	<script type="text/javascript" src="/plugin/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
	<script type="text/javascript" src="/plugin/datatables-buttons/js/dataTables.buttons.min.js"></script>
	<script type="text/javascript" src="/plugin/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
	<script type="text/javascript" src="/plugin/datatables-buttons/js/buttons.html5.min.js"></script>
	<script type="text/javascript" src="/plugin/datatables-buttons/js/buttons.print.min.js"></script>
	<script type="text/javascript" src="/plugin/datatables-buttons/js/buttons.colVis.min.js"></script>
*/-->

	<!--/* nestable */-->
	<link rel="stylesheet" href="/plugin/nestable/nestable.css?V=11">
	<script type="text/javascript" src="/plugin/nestable/jquery.nestable.js"></script>

	<!--/* ChartJS */-->
	<script type="text/javascript" src="/plugin/chartjs/chart.min.js"></script>

	<!--/* date-range-picker */-->
	<link rel="stylesheet" href="/plugin/daterangepicker/css/daterangepicker.css">
	<script type="text/javascript" src="/plugin/moment/moment.min.js"></script>
	<script type="text/javascript" src="/plugin/moment/moment-with-locales.js"></script>
	<script type="text/javascript" src="/plugin/daterangepicker/daterangepicker.js"></script>

	<!--/* date-time-picker */-->
	<link rel="stylesheet" href="/plugin/jquery.datetimepicker/jquery.datetimepicker.min.css">
	<script type="text/javascript" src="/plugin/jquery.datetimepicker/jquery.datetimepicker.full.js"></script>

	<!--/* full-calendar */-->
	<link rel="stylesheet" href="/plugin/full-calendar/full-calendar.min.css">
	<script type="text/javascript" src="/plugin/full-calendar/full-calendar.min.js"></script>
	<script type="text/javascript" src="/plugin/full-calendar/fullcalendar-moment.js"></script>

	<!--/* ckeditor */-->
	<script type="text/javascript" src="/plugin/ckeditor5-35.1.0/build/ckeditor.js"></script>
	<link type="text/css" rel="stylesheet"  href="/plugin/ckeditor5-35.1.0/css/ckeditor.min.css"/>

	<!--/* Swiper */-->
	<link rel="stylesheet" href="/plugin/swiper-8.4.2/package/swiper-bundle.min.css">
	<script type="text/javascript" src="/plugin/swiper-8.4.2/package/swiper-bundle.min.js"></script>

	<!--/* html2canvas */-->
	<script type="text/javascript" src="/plugin/html2canvas/html2canvas.min.js"></script>

	<!--/* Crypto-js */-->
	<script type="text/javascript" src="/js/crypto-js.min.js" th:src="@{/js/crypto-js.min.js}"></script>

	<!--/* Wayplus Theme style */-->
	<link rel="stylesheet" href="/css/inc/common.css">
	<link rel="stylesheet" href="/css/manage/content.css">
	<link rel="stylesheet" href="/css/manage/adminlte.css">
	<link rel="stylesheet" href="/css/manage/option.css">
	<link rel="stylesheet" href="/css/manage/icon_custom.css">
	<link rel="stylesheet" href="/css/manage/attach_file.css">
	<link rel="stylesheet" href="/css/manage/table_menu.css">
	<link rel="stylesheet" href="/css/manage/buttons.css">

	<!--/* Wayplus JS */-->
	<script type="text/javascript" src="/js/common.js"></script>
	<script type="text/javascript" src="/js/manage/fnJson.js"></script>
	<script type="text/javascript" src="/js/util/file/attachFile.js"></script>
	<script type="text/javascript" src="/js/util/map/mapCustom.js"></script>
	<script type="text/javascript" src="/js/util/date/dateUtil.js" defer="defer"></script>


	<script type="text/javascript" th:inline="javascript">
		var currentDate = new Date();
/*
		var separator= ' ~ ';
		var _daterangepickerOptionSingleOnlyDate = {
				minYear: 1999,
				maxDate:moment().add(-1, 'hour'),
				autoUpdateInput: true,
				singleDatePicker:true,
				showDropdowns: true,
				showCustomRangeLabel:false,
				timePicker: false,
				timePicker24Hour: true,
				timePickerMinutes:false,
				timePickerSeconds:false,
				drops:"auto",
				locale: {
					format: 'YYYY-MM-DD',
					applyLabel: "적용",
					cancelLabel: "취소",
					daysOfWeek: ["일", "월", "화", "수", "목", "금", "토"],
					monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
					separator:separator
				},
				ranges:null
			};
		var _daterangepickerOptionSingleDateTime = {
				minYear: 1999,
				maxDate:moment().add(-1, 'hour'),
				autoUpdateInput: true,
				singleDatePicker:true,
				showDropdowns: true,
				showCustomRangeLabel:false,
				timePicker: true,
				timePicker24Hour: true,
				timePickerMinutes:true,
				timePickerSeconds:true,
				drops:"auto",
				locale: {
					format: 'YYYY-MM-DD HH:mm:ss',
					applyLabel: "적용",
					cancelLabel: "취소",
					daysOfWeek: ["일", "월", "화", "수", "목", "금", "토"],
					monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
					separator:separator
				},
				ranges:null
			};
		var _daterangepickerOptionRangeOnlyDate = {
				minYear: 1999,
				maxDate:moment().add(-1, 'hour'),
				autoUpdateInput: true,
				singleDatePicker:false,
				showDropdowns: true,
				showCustomRangeLabel:false,
				timePicker: false,
				timePicker24Hour: true,
				timePickerMinutes:false,
				timePickerSeconds:false,
				drops:"auto",
				locale: {
					format: 'YYYY-MM-DD',
					applyLabel: "적용",
					cancelLabel: "취소",
					daysOfWeek: ["일", "월", "화", "수", "목", "금", "토"],
					monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
					separator:separator
				},
				ranges:null
			};
		var _daterangepickerOptionRangeDateTime = {
				minYear: 1999,
				maxDate:moment().add(-1, 'hour'),
				autoUpdateInput: true,
				singleDatePicker:false,
				showDropdowns: true,
				showCustomRangeLabel:false,
				timePicker: true,
				timePicker24Hour: true,
				timePickerMinutes:true,
				timePickerSeconds:true,
				drops:"auto",
				locale: {
					format: 'YYYY-MM-DD HH:mm:ss',
					applyLabel: "적용",
					cancelLabel: "취소",
					daysOfWeek: ["일", "월", "화", "수", "목", "금", "토"],
					monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
					separator:separator
				},
				ranges:null
			};
*/
		$(document).ready(function(){
			fnMngrMenuActiveStatus();

			$('.date-single-picker').daterangepicker(_daterangepickerOptionSingleOnlyDate, function(start, end, label) {});
			$('.date-single-time-picker').daterangepicker(_daterangepickerOptionSingleDateTime, function(start, end, label) {});

			$('.date-range-picker').daterangepicker(_daterangepickerOptionRangeOnlyDate, function(start, end, label) {});
			$('.date-range-time-picker').daterangepicker(_daterangepickerOptionRangeDateTime, function(start, end, label) {});
		});

		$(window).on('load',function(){
			$('.selectpicker').selectpicker();
		})

		fnMngrMenuActiveStatus = function(){
			var urlPath = location.pathname;
			var lastPath = urlPath.substr(urlPath.lastIndexOf('/')+1);
			var urlPath2d;

			var urlDepth = urlPath.match(/\//g).filter(item => item !== '').length;

			if(lastPath === 'view' || lastPath === 'form' || lastPath === 'list-banner' ){
				urlPath2d = urlPath.substr(0, urlPath.lastIndexOf('/'));
				//console.log('urlPath2d', urlPath2d);
			}
/*
			console.log('URL INFO \n' +
				"urlPath : "+urlPath + "\n" +
				"urlPath2d : "+urlPath.substr(0, urlPath.lastIndexOf('/')) + "\n"
			 );
*/
			$('#side-nav-menu > li').each(function(i,e){
				var liParent   = $(this);
				var liParent_a = $('> a.nav-link', this);
				var aUrl       = $(liParent_a).attr('href');
				var aUrlDepth  = -1;

				if( aUrl != undefined && aUrl != null && aUrl !== "#" )
					aUrlDepth = aUrl.match(/\//g).filter(item => item !== '').length;
/*
				console.log(
					'urlPath : '+ urlPath + '\n'
					+ 'urlPath2d : ' + urlPath2d + '\n'
					+ 'lastPath : ' + lastPath + '\n'
					+ 'aUrl : ' + aUrl + '\n'
					+ '매칭 결과 1(다이렉트비교) :'+ `${urlPath == aUrl}, `+ urlPath +'\n'
					+ '매칭 결과 2(a, URL비교) :'+(aUrl !== undefined ?  aUrl.startsWith( urlPath2d ) + ", " + urlPath2d+'\n' : '\n')
					+ '매칭 결과 3(URL비교) :'+ urlPath.startsWith(aUrl)+'\n'
					+ 'Depth 비교' + `urlDepth : ${urlDepth}, aUrlDepth : ${aUrlDepth}`
				);
*/
				if(aUrl === urlPath ||
				   ((aUrl!==undefined && aUrl !== "#") && aUrl.startsWith(urlPath2d) && urlDepth === aUrlDepth) ||
				   urlPath.startsWith(aUrl) )
				     $(this).addClass('active');
				else $(this).removeClass('active');

 				//console.log( `${urlPath}`, `${urlPath2d}`);

				$('ul > li',$(this)).each(function(j,e){
					var liChlid = $(this);
					var liChlid_a = $('a', $(liChlid));
					var liUrl =  $(liChlid_a).attr('href');
					//var liUrlDepth = liUrl.match(/\//g).filter(item => item !== '').length;

					if(urlPath !== '/manage' &&
					   urlPath !== '/manage/index' ){
/*
						console.log(
							'urlPath : '+ urlPath + '\n' +
							'liUrl : ' + liUrl + '\n' +
							'매칭 결과 1(다이렉트비교) :'+ `${urlPath == liUrl}, `+ urlPath +'\n'+
						    '매칭 결과 2(li, URL비교) :'+ liUrl.startsWith( urlPath2d ) + ", " + urlPath2d+'\n'+
						    '매칭 결과 3(URL비교) :'+ urlPath.startsWith(liUrl)
						);
*/
						if( urlPath === liUrl ||
							(liUrl.startsWith( urlPath2d )  ) ||
							urlPath.startsWith(liUrl) ){

	 						$(liChlid_a).parents('li.nav-item').each(function(i,e){
								if( !$(e).hasClass('menu-open') ){
									$(e).addClass('menu-open');
								}
								$(e).children('a.nav-link').each(function(i,e1){
									if(!$(e1).hasClass('active')){
										$(e1).addClass('active');
									}
								});
							});
						}
					} else {
						$(`a.nav-link[href='/manage/index']`).closest('li').addClass('active');
					}
				});
			})
		};

		fnGetUrl = function( url ){
			return url.substring(0,url.lastIndexOf('/'))
		};
			/* fnMakeCkeditor 사용법
				let editor;
	 	    	fnMakeCkeditor($('#editorComment')[0],  false);
				fnMakeCkeditor($('#editorComment')[0],  false).then(
					makedEditor => {
						editor = makedEditor;
					});
			*/
/**/
		fnMakeCkeditor = function(target, isReadOnly = false){
    		let _editor;

    		if(target != undefined){
//				console.info(target);
//     			setTimeout(() => {}, 1000);
	    		return ClassicEditor
	    			.create(target,{
			                language: 'ko',
			                simpleUpload:{
			                    uploadUrl: '/admin/ck-image-upload',
			                    withCredentials: true,
			                    headers:{
			                        [[${_csrf.headerName}]]: [[${_csrf.token}]],
			                    }
			                },
			                fontFamily: {
			                    options: ['Noto Sans KR', 'Noto Serif KR', 'SEBANG_Gothic_Bold', 'Pretendard', 'NanumGothic', 'NanumMyeongjo', 'NanumSquare'],
			                    supportAllValues: true
			                },
			                fontSize: {
			                    options: ['12px','13px','14px','15px','16px','18px','20px','24px','28px','32px','36px', '48px'],
			                    supportAllValues: true
			                },
			                table:{
			                    tableProperties: {
			                        defaultProperties:{
			                            alignment: 'left',
			                        }
			                    }
			                },
			                ImageCaption:false,
			            }
			        ).then( newEditor => {
			        	_editor = newEditor;
		        		const toolbarElement = _editor.ui.view.toolbar.element;
//						console.log(`newEditor : ${newEditor}`);
//	 	        		console.log(`editor : ${_editor}`);
//	 		        	console.log(isReadOnly, toolbarElement, `${toolbarElement.style.display}`);
			        	if ( isReadOnly ) {
		                    toolbarElement.style.display = 'none';
		                    _editor.enableReadOnlyMode("docs-snippet")
		                } else {
		                    toolbarElement.style.display = 'flex';
		                    _editor.disableReadOnlyMode("docs-snippet")
		                }

		                _editor.ui.editor.config.height = '100%'

			        	return _editor;
			        }).catch( error => {
						console.error('error가 왔어요');
						console.error(error);
					} );
    		}
    	}

		function formValidNullCheck(item, type, classname){
			if($(item) === undefined) return false;
			switch (type){
				case 'input':
					if($(item).val() === undefined || $(item).val() === null || $(item).val().trim() === ''){
						$(item).addClass(classname);
						$(item).focus();
					}else{
						$(item).removeClass(classname);
					}
					break;
				case 'select':
				default:
					if($(item).val() === undefined || $(item).val() === null){
						$(item).addClass(classname);
						$(item).focus();
					}else{
						$(item).removeClass(classname);
					}
					break;
			}
			return true;
		}
	</script>
</head>

<!-- Preloader -->
<div class="preloader flex-column justify-content-center align-items-center" th:fragment="common-preloader-include">
	<img class="animation__shake" src="/images/icons/logo/wayplus_logo.svg" alt="wayplus Logo" height="60" width="60">
</div>

</html>